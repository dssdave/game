<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Princess D's Star Adventure</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #87ceeb; /* Light blue sky */
        }
        canvas {
            border: 1px solid black;
            background-color: #7cfc00; /* Bright green ground */
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="400"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Game setup
        let gameState = 'start';
        let score = 0;
        const totalStars = 3;

        // Princess setup
        let princess = {
            x: 50,
            y: 300,
            width: 80,  // Bigger princess
            height: 80,
            speed: 3    // Slower speed
        };

        // Stars setup
        let stars = [
            {x: 200, y: 300, size: 60},  // Big stars, all on the ground
            {x: 400, y: 300, size: 60},
            {x: 600, y: 300, size: 60}
        ];

        // Handle key presses
        const keys = {};
        document.addEventListener('keydown', (e) => keys[e.key] = true);
        document.addEventListener('keyup', (e) => keys[e.key] = false);

        // Check if princess touches a star
        function rectIntersect(r1, r2) {
            return !(r1.x + r1.width < r2.x || r1.x > r2.x + r2.width ||
                     r1.y + r1.height < r2.y || r1.y > r2.y + r2.height);
        }

        // Move the princess
        function updatePrincess() {
            let dx = 0;
            if (keys['ArrowLeft']) dx -= princess.speed;
            if (keys['ArrowRight']) dx += princess.speed;

            princess.x += dx;

            // Keep princess on the screen
            princess.x = Math.max(0, Math.min(canvas.width - princess.width, princess.x));

            // Collect stars
            for (let i = stars.length - 1; i >= 0; i--) {
                let star = stars[i];
                if (rectIntersect(princess, {x: star.x, y: star.y, width: star.size, height: star.size})) {
                    stars.splice(i, 1);
                    score++;
                    if (score === totalStars) gameState = 'won';
                }
            }
        }

        // Draw the princess
        function drawPrincess() {
            ctx.fillStyle = '#ff69b4'; // Pink princess
            ctx.fillRect(princess.x, princess.y, princess.width, princess.height);
            ctx.fillStyle = 'black';  // Happy face
            ctx.fillRect(princess.x + 20, princess.y + 20, 10, 10); // Left eye
            ctx.fillRect(princess.x + 50, princess.y + 20, 10, 10); // Right eye
            ctx.fillRect(princess.x + 30, princess.y + 50, 20, 10); // Smiling mouth
        }

        // Draw the stars
        function drawStars() {
            ctx.fillStyle = '#ffd700'; // Gold stars
            for (let star of stars) {
                ctx.beginPath();
                ctx.arc(star.x + star.size / 2, star.y + star.size / 2, star.size / 2, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        // Draw the score
        function drawScore() {
            ctx.fillStyle = 'black';
            ctx.font = '30px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(`Stars: ${score}/${totalStars}`, 10, 40);
        }

        // Main game loop
        function gameLoop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (gameState === 'start') {
                ctx.fillStyle = 'black';
                ctx.font = '50px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Princess Dâ€™s Stars', canvas.width / 2, canvas.height / 2 - 50);
                ctx.font = '30px Arial';
                ctx.fillText('Press any key to start', canvas.width / 2, canvas.height / 2 + 50);
                if (Object.values(keys).some(k => k)) {
                    gameState = 'playing';
                    keys = {};
                }
            } else if (gameState === 'playing') {
                updatePrincess();
                drawStars();
                drawPrincess();
                drawScore();
            } else if (gameState === 'won') {
                ctx.fillStyle = 'black';
                ctx.font = '50px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('You Win!', canvas.width / 2, canvas.height / 2 - 50);
                ctx.font = '30px Arial';
                ctx.fillText('Press any key to play again', canvas.width / 2, canvas.height / 2 + 50);
                if (Object.values(keys).some(k => k)) {
                    resetGame();
                    gameState = 'start';
                    keys = {};
                }
            }

            requestAnimationFrame(gameLoop);
        }

        // Reset the game
        function resetGame() {
            princess.x = 50;
            score = 0;
            stars = [
                {x: 200, y: 300, size: 60},
                {x: 400, y: 300, size: 60},
                {x: 600, y: 300, size: 60}
            ];
        }

        // Start the game
        gameLoop();
    </script>
</body>
</html>
