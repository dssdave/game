<!DOCTYPE html>
<html>
<head>
    <title>Princess RPG</title>
    <style>
        canvas {
            border: 1px solid black;
        }
        #game-container {
            text-align: center;
            font-family: Arial, sans-serif;
        }
        #inventory {
            margin-top: 10px;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        <div id="inventory">
            Flowers: <span id="flowerCount">0</span> | 
            Coins: <span id="coinCount">0</span>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Game state
        let gameState = {
            currentScene: 'town',
            flowers: 0,
            coins: 0
        };

        // Player properties
        const player = {
            x: 400,
            y: 300,
            width: 32,
            height: 32,
            speed: 4
        };

        // Game objects
        const objects = {
            town: [
                // Castle
                {type: 'building', x: 600, y: 100, width: 100, height: 150, interior: 'castle'},
                // House
                {type: 'building', x: 100, y: 400, width: 80, height: 60, interior: 'house'},
                // Flowers
                {type: 'flower', x: 200, y: 200, width: 20, height: 20},
                {type: 'flower', x: 300, y: 250, width: 20, height: 20},
                // Coins
                {type: 'coin', x: 400, y: 150, width: 20, height: 20},
                {type: 'coin', x: 500, y: 400, width: 20, height: 20}
            ],
            castle: [
                {type: 'door', x: 380, y: 500, width: 40, height: 40, destination: 'town'}
            ],
            house: [
                {type: 'door', x: 380, y: 500, width: 40, height: 40, destination: 'town'}
            ]
        };

        // Simple sprite drawing functions
        function drawSprite(type, x, y, width, height) {
            ctx.save();
            switch(type) {
                case 'player':
                    ctx.fillStyle = '#ff69b4'; // Pink princess dress
                    ctx.fillRect(x, y, width, height);
                    ctx.fillStyle = '#ffd700'; // Golden crown
                    ctx.fillRect(x + 10, y - 10, 12, 10);
                    break;
                case 'building':
                    ctx.fillStyle = '#808080';
                    ctx.fillRect(x, y, width, height);
                    ctx.fillStyle = '#ff0000'; // Door
                    ctx.fillRect(x + width/2 - 10, y + height - 20, 20, 20);
                    break;
                case 'flower':
                    ctx.fillStyle = '#ff00ff';
                    ctx.beginPath();
                    ctx.arc(x + width/2, y + height/2, width/2, 0, Math.PI * 2);
                    ctx.fill();
                    break;
                case 'coin':
                    ctx.fillStyle = '#ffd700';
                    ctx.beginPath();
                    ctx.arc(x + width/2, y + height/2, width/2, 0, Math.PI * 2);
                    ctx.fill();
                    break;
                case 'door':
                    ctx.fillStyle = '#8b4513';
                    ctx.fillRect(x, y, width, height);
                    break;
            }
            ctx.restore();
        }

        // Collision detection
        function checkCollision(obj1, obj2) {
            return obj1.x < obj2.x + obj2.width &&
                   obj1.x + obj1.width > obj2.x &&
                   obj1.y < obj2.y + obj2.height &&
                   obj1.y + obj1.height > obj2.y;
        }

        // Keyboard controls
        const keys = {};
        document.addEventListener('keydown', (e) => keys[e.key] = true);
        document.addEventListener('keyup', (e) => keys[e.key] = false);

        function update() {
            // Movement
            if (keys['ArrowUp']) player.y -= player.speed;
            if (keys['ArrowDown']) player.y += player.speed;
            if (keys['ArrowLeft']) player.x -= player.speed;
            if (keys['ArrowRight']) player.x += player.speed;

            // Keep player in bounds
            player.x = Math.max(0, Math.min(canvas.width - player.width, player.x));
            player.y = Math.max(0, Math.min(canvas.height - player.height, player.y));

            // Check collisions
            const currentObjects = objects[gameState.currentScene];
            for (let i = currentObjects.length - 1; i >= 0; i--) {
                const obj = currentObjects[i];
                if (checkCollision(player, obj)) {
                    switch(obj.type) {
                        case 'flower':
                            gameState.flowers++;
                            currentObjects.splice(i, 1);
                            break;
                        case 'coin':
                            gameState.coins++;
                            currentObjects.splice(i, 1);
                            break;
                        case 'building':
                            gameState.currentScene = obj.interior;
                            player.x = 400;
                            player.y = 300;
                            break;
                        case 'door':
                            gameState.currentScene = obj.destination;
                            player.x = 400;
                            player.y = 300;
                            break;
                    }
                }
            }
        }

        function draw() {
            // Clear canvas
            ctx.fillStyle = gameState.currentScene === 'town' ? '#90ee90' : '#deb887';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw objects
            objects[gameState.currentScene].forEach(obj => {
                drawSprite(obj.type, obj.x, obj.y, obj.width, obj.height);
            });

            // Draw player
            drawSprite('player', player.x, player.y, player.width, player.height);

            // Update inventory display
            document.getElementById('flowerCount').textContent = gameState.flowers;
            document.getElementById('coinCount').textContent = gameState.coins;
        }

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // Start the game
        gameLoop();
    </script>
</body>
</html>
